\section{Android-Client}

In diesem Abschnitt wird die Entwicklung der Android-Bibliothek beschrieben. Zur Entwicklung wurde die plattformübergreifende IDE \emph{IntelliJ Idea}\footnote{\url{http://www.jetbrains.com/idea/}} verwendet.

Alternativ kann auch die offizielle Anroid \ac{IDE}, \emph{Android Studio}\footnote{\url{http://developer.android.com/sdk/installing/studio.html}}, verwendet werden, welches auf der \emph{Community Edition} von \emph{IntelliJ Idea} basiert, sich zum aktuellen Zeitpunkt jedoch nur in einer \emph{early access preview} verfügbar ist.
Die Projektdateien sind untereinander kompatibel.

Screenshots und Anleitungen beziehen sich diesbezüglich auf diese Software. Konfigurationen und Einstellungen können sich zu anderen IDEs unterscheiden.
Die Quellen zu den Projekten befinden sich im Github-Repository im Unterordner \texttt{client}.

\subsection{Ziele}
Bei der Konzeption und Entwicklung der Android Bibliothek wurden mehrere Ziele verfolgt.
Das Hauptziel ist die Erstellung einer Bibliothek, die sich leicht in Anwendungen integrieren lässt und die Funktionen aufwändiger \ac{UX} Testaufbauten mit externen Kameras, Mikrofonen etc. ersetzt.
Dazu sollen die technischen Möglichkeiten moderner Endgeräte genutzt werden:


\subsection{Verwendete Bibliotheken von Drittanbietern}
Neben dem offiziellen Android SDK \footnote{API Level 19, Android 4.2.2} werden die folgenden externe Bibliotheken eingesetzt:
\begin{description}
	\item[Android Asynchronous Http Client\footnote{\url{http://loopj.com/android-async-http/}}] 
	Ein Callback-basierter HTTP Client, aufbauend auf Apache HTTP\footnote{\url{http://hc.apache.org/httpcomponents-client-ga/}} Bibliotheken. Diese quelloffene Android Bibliothek bietet Klassen und Methoden für asynchrone HTTP Aufrufe und wird auch in großen Projekten wie \emph{Instagram} oder \emph{Pinterest} eingesetzt. Die zusätzliche Abstraktionsschicht übernimmt die Fehlerbehandlung, wiederholte Verbindungsversuche und das übertragen von großen Datenmengen auf einfach anzuwendende Weise. Das Projekt unter der Apache License, Version 2.0\footnote{\url{http://www.apache.org/licenses/LICENSE-2.0}}, veröffentlicht und kann unter deren Bedingungen frei genutzt werden.
	\item[Google GSON\footnote{\url{https://code.google.com/p/google-gson/}}]
	Der Datenabruf vom Server erfolgt mittels \ac{JSON}-Objekte im HTML Body. Um diese Objekte schnell und einfach in Java Objekte umzuwandeln bietet GSON entsprechende Klassen an, die das Implementieren von eigenen Parsern etc. überflüssig macht.
	Die quelloffenen, universell einsetzbare, Java Bibliothek wird ebenfalls unter der Apache License, Version 2.0 veröffentlicht.
%	\item[Android Support Library\footnote{\url{http://developer.android.com/tools/support-library/index.html}}]
%	Diese zusätzliche, nicht im Android SDK enthaltene, Bibliothek bietet zahlreiche zusätzliche Klassen an, die nicht Bestandteil des offiziellen SDK sind, jedoch nützliche Erweiterungen. Z.B. gibt es Klassen für die applikationsinterne Kommunikation und zusätzliche \ac{UI}-Elemente und Layouts.
%	Diese Bibliothek steht unter der \emph{Creative Commons Attribution 2.5}\footnote{http://creativecommons.org/licenses/by/2.5/} Lizenz und kann unter deren Bedingungen verwendet werden.
\end{description}

\subsection{Bibliotheksmodul}
Zur Entwicklung der Bibliothek wurden zwei Projekte verwendet - Einmal das Projekt für die Bibliothek selbst und weiterhin ein Android-Projekt zum Testen der Funktionen während der Entwicklung. 

Ziel der Entwicklung ist ein funktionsfähiger Prototyp, in welchem geplante Kernfunktionen implementiert sind.
Die vorliegende Implementierung ist als \emph{Proof of Concept} anzusehen und weder vollständig, noch frei von Fehlern und Bugs.

\subsubsection{Testapplikation}
Für die Entwicklung und das Testen der Bibliothek wird eine Applikation benötigt in die diese eingebunden wird.
Dazu wurde eine kleine Testapplikation entwickelt, die verschiedene \ac{UI}-Elemente enthält.
Diese setzen sich aus einigen häufig verwendeten, gewöhnlichen \ac{UI}-Klassen des Android \ac{SDK} zusammen \footnote{\url{http://developer.android.com/design/building-blocks/index.html}}:
\begin{itemize}
	\item Activities
	\item Views
	\item Fragments
	\item Buttons
	\item Dialoge
	\item Toasts.
\end{itemize}
Anfangs bestand die Testapplikation aus einer einzigen Activity und wurde im Verlauf des Projekts erweitert.


\subsubsection{Monolithischer Wrapper}
Um die Benutzung zu vereinfachen soll sich die Bibliothek möglichst einfach in neue und bestehende Anwendungen integrieren lassen.
Dies wird u.a. dadurch erreicht, dass Aufrufe nur an eine einzige Klasse gerichtet werden.
Die dahinter liegenden Klassen werden im Sinne des \emph{Facade}-Entwurfsmusters \cite[vgl.][40\psq]{designpattern} \enquote{abgeschirmt}.
Die Klasse \texttt{Hipsterbility} bildet die Schnittstelle zu der Applikation, welche die Bibliothek verwendet.
Diese Art der Abstraktion soll die Benutzung vereinfachen, da nur mit einer einzigen Klasse interagiert werden muss. 
Dies reduziert die Anzahl der Methodenaufrufe auf ein Minimum, wie im Beispiel angedeutet (siehe Listing \ref{list_hipsterbility_client_init}).

%TODO: ggf überarbeiten, falls nötig
\begin{lstlisting}[label=list_hipsterbility_client_init,language=Java, caption=Beispiel für Initialisierung der Bibliothek]
// Singleton Instanz holen und aktuelle Activity uebergeben
Hipsterbility.getInstance().enableTesting(this);

// Module aktivieren
Hipsterbility.MODULE.VIDEO.enabled 	= true; 	// Frontkamera
Hipsterbility.MODULE.AUDIO.enabled 	= true;		// Mikrofon
Hipsterbility.MODULE.SCREEN.enabled = true;		// Bildschirminhalt
\end{lstlisting}

Funktionen können über die öffentliche, verschachtelte statische Aufzählung \texttt{MODULE} in der Klasse \texttt{Hipsterbility} gesteuert.
Jedes Element hat eine boolsche Variable \texttt{enabled}.
Hat diese den Wert \texttt{true}, wird die entsprechende Funktion aktiviert.
Die aktivierten Funktionen entscheiden in ihrer Kombination, welche konkrete Implementierung genutzt wird (siehe Abschnitt \ref{sec_module}).

\subsection{Module zur Datenerfassung \label{sec:module}}
Primärziel der Android Bibliothek ist das Sammeln von Daten, die bei der Interaktion mit der zu testenden Anwendung anfallen.
Angelehnt an gängige Testmethoden (siehe Abschnitt \ref{sec:testmethoden}) wird ein beispielhafter Testaufbau mit folgenden Elementen abgebildet:
\begin{enumerate}
	\item Aufnahme des Gesichts der Testperson durch die Frontkamera des Geräts.
	\item Mitschnitt von verbalen Äußerungen mittels des integrierten Mikrofons.
	\item Abgreifen des Bildschirminhalts mit Visualisierung von Eingaben.
\end{enumerate}


\subsubsection{Frontkamera und Mikrofon}
Bei der Auswertung von Usability-Tests kann die Mimik der Testperson zur Interpretation beitragen.
Außerdem kann durch das Kamerabild gesehen werden, ob die Testperson sich auf die gestellte Aufgabe konzentriert oder abgelenkt ist.
Dies ist von Bedeutung, wenn der Zeitfaktor bei der Auswertung berücksichtigt wird.
Neben dem Kamerabild werden Sprache und Umgebungsgeräusche mit dem integrierten Mikrofon aufgezeichnet.
Einerseits können so unbewusste Aussagen aufgezeichnet und bewertet werden, andererseits erlaubt dies den Einsatz von \emph{Thinking Aloud Tests}, bei denen die Testperson gezielt subjektive Eindrücke verbal äußert.  %TODO: Belege suchen

Die Herausforderung bei der Implementierung stellt sich durch Beschränkungen des Android Betriebssystems.
Dieses sieht vor, dass bei der Aufnahme von Videos und Fotos mit der Kamera eine Vorschau auf dem Bildschirm dargestellt wird.
Dieser soll jedoch vollständig der zu testenden Anwendung zur Verfügung stehen.
Die Lösung besteht darin einen \texttt{SurvaceView} zu erstellen, welcher als System Overlay über allen anderen Bildschirmelementen gezeichnet wird. 
Dieser wird mit einem transparenten Pixelformat versehen, auf 1x1 Pixel verkleinert und in die obere linke Bildschirmecke verschoben.

Somit wird eine, für den Benutzer nicht sichtbare, Vorschau erstellt und die Aufzeichnung kann über die vom System bereitgestellten Klassen erfolgen.


\subsubsection{Bildschirminhalt}


\subsection{Weitere Funktionen und Ausblick}

\subsection{Einbinden der Bibliothek in eigene Anwendungen}


\subsection{Benutzeroberfläche und Integration in Android Applikationen}


\subsubsection{Dynamisches Einbinden - Pre-Dexing}

Beim Pre-Dexing können mehrere Android-Projekte zu einem Projekt hinzugefügt werden. 
%TODO: updating

Da die Bibliothek neueste Funktionen des Android-Betriebssystems verwendet, muss auf dem  Gerät zur Kompilierung einer Anwendung aktuelle Build-Tools der Android-SDK vorliegen.
Im Falle der Bibliothek ist dies API-Level 19. Offenbar hat sich hier ein Bug eingeschlichen und es ist unter der Version 19.0 kein Pre-Dexing möglich.
Dies wurde allerdings bereits behoben. Es sei gesagt, dass mindestens die Version 19.0.1 verwendet werden muss um Pre-Dexing durchführen zu können.
%TODO: update, wichtig? Screenshot? 

\subsubsection{Statisches Einbinden als JAR-Archiv}

\subsection{Ausblick und Weiterentwicklung}
